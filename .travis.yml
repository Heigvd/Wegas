language: java
jdk:
- oraclejdk8
services: postgresql
branches:
  only:
  - master
sudo: false
before_script:
- psql -c 'create database wegas_test;' -U postgres
- psql -c "create user \"user\" with superuser password '1234';" -U postgres
- openssl aes-256-cbc -K $encrypted_fb8fa6aea355_key -iv $encrypted_fb8fa6aea355_iv
  -in .id_rsa.enc -out .id_rsa -d
- chmod 400 .id_rsa
install:
- mvn -P release-profile generate-resources
script:
- mvn -P release-profile install
after_success:
- if [ "$TRAVIS_PULL_REQUEST" == "false" ]; then scp -B -i .id_rsa -oStrictHostKeyChecking=no
  wegas-app/target/Wegas.war drop@dev.albasim.ch:/home/drop/autodeploy/; fi
before_install:
