YUI.add("inputex-password",function(c){var a=c.inputEx,b=c.Lang;a.PasswordField=function(d){a.PasswordField.superclass.constructor.call(this,d)};a.PasswordField.byId={};c.extend(a.PasswordField,a.StringField,{setOptions:function(d){a.PasswordField.superclass.setOptions.call(this,d);this.options.className=d.className?d.className:"inputEx-Field inputEx-PasswordField";this.options.regexp=d.regexp||a.regexps.password;this.options.strengthIndicator=b.isUndefined(d.strengthIndicator)?false:d.strengthIndicator;this.options.capsLockWarning=b.isUndefined(d.capsLockWarning)?false:d.capsLockWarning;a.PasswordField.byId[d.id]=this;var e;if(d.confirm&&(e=a.PasswordField.byId[d.confirm])){this.setConfirmationField(e)}},renderComponent:function(){this.wrapEl=a.cn("div",{className:"inputEx-StringField-wrapper"});var d={};d.type="password";d.size=this.options.size;if(this.options.name){d.name=this.options.name}this.el=a.cn("input",d);this.wrapEl.appendChild(this.el);this.fieldContainer.appendChild(this.wrapEl);if(this.options.capsLockWarning){this.capsLockWarning=a.cn("div",{className:"capsLockWarning"},{display:"none"},a.messages.capslockWarning);this.wrapEl.appendChild(this.capsLockWarning)}if(this.options.strengthIndicator){this.strengthEl=a.cn("div",{className:"inputEx-Password-StrengthIndicator"},null,a.messages.passwordStrength);this.strengthBlocks=[];for(var e=0;e<4;e++){var f=a.cn("div",{className:"inputEx-Password-StrengthIndicatorBlock"});this.strengthEl.appendChild(f);this.strengthBlocks[e]=c.one(f)}this.wrapEl.appendChild(this.strengthEl)}},setConfirmationField:function(d){this.options.confirmPasswordField=d;this.options.messages.invalid=a.messages.invalidPasswordConfirmation;this.options.confirmPasswordField.options.confirmationPasswordField=this},validate:function(){if(this.options.confirmPasswordField){if(this.options.confirmPasswordField.getValue()!=this.getValue()){return false}}return a.PasswordField.superclass.validate.call(this)},getStateString:function(d){if(d==a.stateInvalid&&this.options.minLength&&this.el.value.length<this.options.minLength){return a.messages.invalidPassword[0]+this.options.minLength+a.messages.invalidPassword[1]}return a.StringField.superclass.getStateString.call(this,d)},onInput:function(d){a.PasswordField.superclass.onInput.call(this,d);if(this.options.confirmationPasswordField){this.options.confirmationPasswordField.setClassFromState()}},onKeyPress:function(i){a.PasswordField.superclass.onKeyPress.call(this,i);if(this.options.capsLockWarning){var h=i?i:window.event;if(!h){return}var f=h.target?h.target:h.srcElement;var j=-1;if(h.which){j=h.which}else{if(h.keyCode){j=h.keyCode}}var g=false;if(h.shiftKey){g=h.shiftKey}else{if(h.modifiers){g=!!(h.modifiers&4)}}var d=((j>=65&&j<=90)&&!g)||((j>=97&&j<=122)&&g);this.setCapsLockWarning(d)}},onKeyUp:function(d){a.PasswordField.superclass.onKeyUp.call(this,d);if(this.options.strengthIndicator){b.later(0,this,this.updateStrengthIndicator)}},setCapsLockWarning:function(d){this.capsLockWarning.style.display=d?"":"none"},updateStrengthIndicator:function(){var g=a.PasswordField.getPasswordStrength(this.getValue()),e,d,f;for(e=0;e<4;e++){d=(g>=e*25)&&(g>0);f=d?"#4AE817":"#FFFFFF";this.strengthBlocks[e].setStyle("backgroundColor",f)}}});a.PasswordField.getPasswordStrength=function(k){var g=(k.length);if(g>7){g=7}var i=k.replace(/[0-9]/g,"");var j=(k.length-i.length);if(j>3){j=3}var d=k.replace(/\W/g,"");var f=(k.length-d.length);if(f>3){f=3}var e=k.replace(/[A-Z]/g,"");var l=(k.length-e.length);if(l>3){l=3}var h=((g*10)-20)+(j*10)+(f*20)+(l*10);if(h<0){h=0}if(h>100){h=100}return h};a.registerType("password",a.PasswordField,[{type:"boolean",label:"Strength indicator",name:"strengthIndicator",value:false},{type:"boolean",label:"CapsLock warning",name:"capsLockWarning",value:false}])},"3.0.0a",{requires:["inputex-string"]});