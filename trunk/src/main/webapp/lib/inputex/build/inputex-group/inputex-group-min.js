YUI.add("inputex-group",function(c){var b=c.Lang;var a=c.inputEx;a.Group=function(d){a.Group.superclass.constructor.call(this,d);if(!this.options.value){this.runFieldsInteractions()}};c.extend(a.Group,a.Field,{setOptions:function(d){a.Group.superclass.setOptions.call(this,d);this.options.className=d.className||"inputEx-Group";this.options.fields=d.fields;this.options.flatten=d.flatten;this.options.legend=d.legend||"";this.options.collapsible=b.isUndefined(d.collapsible)?false:d.collapsible;this.options.collapsed=b.isUndefined(d.collapsed)?false:d.collapsed;this.options.disabled=b.isUndefined(d.disabled)?false:d.disabled;this.inputs=[];this.inputsNames={}},render:function(){this.divEl=a.cn("div",{className:this.options.className});if(this.options.id){this.divEl.id=this.options.id}this.renderFields(this.divEl);if(this.options.disabled){this.disable()}},renderFields:function(f){this.fieldset=a.cn("fieldset");this.legend=a.cn("legend",{className:"inputEx-Group-legend"});if(this.options.collapsible){var g=a.cn("div",{className:"inputEx-Group-collapseImg"},null," ");this.legend.appendChild(g);a.sn(this.fieldset,{className:"inputEx-Expanded"})}if(!b.isUndefined(this.options.legend)&&this.options.legend!==""){this.legend.appendChild(a.cn("span",null,null," "+this.options.legend))}if(this.options.collapsible||(!b.isUndefined(this.options.legend)&&this.options.legend!=="")){this.fieldset.appendChild(this.legend)}for(var e=0;e<this.options.fields.length;e++){var d=this.options.fields[e];if(!d){throw new Error("inputEx.Form: One of the provided fields is undefined ! (check trailing comma)")}this.addField(d)}if(this.options.collapsed){this.toggleCollapse()}f.appendChild(this.fieldset)},addField:function(d){var e=this.renderField(d);this.fieldset.appendChild(e.getEl())},renderField:function(e){var d=a(e,this);this.inputs.push(d);if(d.options.name){this.inputsNames[d.options.name]=d}if(d.options.flatten&&b.isObject(d.inputsNames)){c.mix(this.inputsNames,d.inputsNames);this.inputs=this.inputs.concat(d.inputs)}if(!this.hasInteractions&&e.interactions){this.hasInteractions=true}d.on("updated",this.onChange,this);return d},initEvents:function(){if(this.options.collapsible){c.on("click",this.toggleCollapse,this.legend,this)}},toggleCollapse:function(){if(c.one(this.fieldset).hasClass("inputEx-Expanded")){c.one(this.fieldset).replaceClass("inputEx-Expanded","inputEx-Collapsed")}else{c.one(this.fieldset).replaceClass("inputEx-Collapsed","inputEx-Expanded")}},validate:function(){var e=true;for(var f=0;f<this.inputs.length;f++){var d=this.inputs[f];if(!d.isDisabled()){var g=d.getState();d.setClassFromState(g);if(g==a.stateRequired||g==a.stateInvalid){e=false}}}return e},getFieldsStates:function(){var d,e,j,h,g={fields:{},validate:true};for(var f=0;f<this.inputs.length;f++){d=this.inputs[f];e=d.options.name;j=d.getState();h=d.getStateString(j);g.fields[e]={};g.fields[e].valid=true;g.fields[e].message=h;if(j==a.stateRequired||j==a.stateInvalid){g.fields[e].valid=false;g.validate=false}}return g},enable:function(){for(var d=0;d<this.inputs.length;d++){this.inputs[d].enable()}},disable:function(){for(var d=0;d<this.inputs.length;d++){this.inputs[d].disable()}},setValue:function(g,e){if(!g){return}for(var f=0;f<this.inputs.length;f++){var h=this.inputs[f];var d=h.options.name;if(d&&!b.isUndefined(g[d])){h.setValue(g[d],false)}else{h.clear(false)}}this.runFieldsInteractions();if(e!==false){this.fireUpdatedEvt()}},getValue:function(){var f={};for(var e=0;e<this.inputs.length;e++){var d=this.inputs[e].getValue();if(this.inputs[e].options.name){if(this.inputs[e].options.flatten&&b.isObject(d)){c.mix(f,d)}else{f[this.inputs[e].options.name]=d}}}return f},close:function(){for(var d=0;d<this.inputs.length;d++){this.inputs[d].close()}},focus:function(){if(this.inputs.length>0){this.inputs[0].focus()}},getFieldByName:function(d){if(!this.inputsNames.hasOwnProperty(d)){return null}return this.inputsNames[d]},findFieldByName:function(l,e){var m=this,j,h;if(e){if(this.inputsNames.hasOwnProperty(l)&&(h=this.inputsNames[l])){for(var k,f=this.inputs,d=0,g=f.length;d<g;++d){k=f[d];if(b.isFunction(k.getFieldByName)&&(h=k.getFieldByName(l,true))){break}}}return h}else{while((j=m.getParentField())&&b.isFunction(j.getFieldByName)){m=j}return m.getFieldByName(l,true)}},onChange:function(e,d){this.runInteractions(d,e);this.fireUpdatedEvt()},runAction:function(d,f){var e=this.getFieldByName(d.name);if(b.isFunction(e[d.action])){e[d.action].call(e)}else{if(b.isFunction(d.action)){d.action.call(e,f)}else{throw new Error("action "+d.action+" is not a valid action for field "+d.name)}}},runInteractions:function(e,l){var g=a.indexOf(e,this.inputs);var k=this.options.fields[g];if(b.isUndefined(k.interactions)){return}var m=k.interactions;for(var h=0;h<m.length;h++){var d=m[h];if(d.valueTrigger===l){for(var f=0;f<d.actions.length;f++){this.runAction(d.actions[f],l)}}}},runFieldsInteractions:function(){if(this.hasInteractions){for(var d=0;d<this.inputs.length;d++){this.runInteractions(this.inputs[d],this.inputs[d].getValue())}}},clear:function(d){for(var e=0;e<this.inputs.length;e++){this.inputs[e].clear(false)}if(d!==false){this.fireUpdatedEvt()}},setErrors:function(f){var e,d;if(b.isArray(f)){for(e=0;e<f.length;e++){d=f[e][0];value=f[e][1];if(this.inputsNames[d]){if(this.inputsNames[d].options.showMsg){this.inputsNames[d].displayMessage(value);c.one(this.inputsNames[d].divEl).replaceClass("inputEx-valid","inputEx-invalid")}}}}else{if(b.isObject(f)){for(d in f){if(f.hasOwnProperty(d)){if(this.inputsNames[d]){if(this.inputsNames[d].options.showMsg){this.inputsNames[d].displayMessage(f[d]);c.one(this.inputsNames[d].divEl).replaceClass("inputEx-valid","inputEx-invalid")}}}}}}},setFieldName:function(e){var d=this.inputs.length;for(var f=0;f<d;f++){this.inputs[f].setFieldName(e+""+((this.inputs[f].el&&this.inputs[f].el.name)||"group-"+f))}},destroy:function(){var d,e,f;for(d=0,e=this.inputs.length;d<e;d++){f=this.inputs[d];f.destroy()}a.Group.superclass.destroy.call(this)}});a.registerType("group",a.Group,[{type:"string",label:"Name",name:"name",value:""},{type:"string",label:"Legend",name:"legend"},{type:"boolean",label:"Collapsible",name:"collapsible",value:false},{type:"boolean",label:"Collapsed",name:"collapsed",value:false},{type:"list",label:"Fields",name:"fields",elementType:{type:"type"}}],true)},"3.0.0a",{requires:["inputex-field"]});