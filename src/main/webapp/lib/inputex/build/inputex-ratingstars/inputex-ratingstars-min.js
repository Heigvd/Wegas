YUI.add("inputex-ratingstars",function(c){var b=c.Lang,a=c.inputEx;a.RatingStars=function(d){a.RatingStars.superclass.constructor.call(this,d);this.resetStars()};c.extend(a.RatingStars,a.Field,{setOptions:function(d){a.RatingStars.superclass.setOptions.call(this,d);if(b.isArray(d.nStars)&&d.nStars[0]&&b.isString(d.nStars[0])){this.options.nStars=d.nStars.length;this.options.starsMessages=d.nStars}else{this.options.nStars=d.nStars||5}this.options.averageValue=b.isNumber(d.averageValue)?Math.round((d.averageValue)*10)/10:null;this.options.disableRate=d.disableRate||false;this.options.nRates=d.nRates;this.options.name=d.name||"stars";this.dontReset=false;this.disabled=d.disabled||false;this.options.message=d.message||a.messages.ratingMsg;this.options.disableMessage=d.disableMessage;this.options.className=d.className?d.className:"inputEx-Field inputEx-RatingStars";this.setMessage()},setMessage:function(){var d=this.options.message.split("%");this.options.message="";if(this.options.averageValue){this.options.message=this.options.message+d[0]+this.options.averageValue+"/"+this.options.nStars}if(this.options.nRates){this.options.message=this.options.message+d[1]+this.options.nRates+d[2]}},renderComponent:function(){this.starsEls=[];this.el=a.cn("div");for(var e=0;e<this.options.nStars;e++){var g=a.cn("div",{id:"star-"+e,className:"inputEx-star"});var f=this;g.index=e;g.onHover=function(){f.onHoverStar(this.index)};g.onClick=function(){f.onClickRating(this.index+1)};this.starsEls.push(g);var d=a.cn("a",{href:"#"+e},null,e);g.appendChild(d);this.el.appendChild(g);c.one(g).on("mouseover",g.onHover,g,true);c.one(g).on("click",g.onClick,g,true)}c.one(this.el).on("mouseout",this.resetStars,this,true);this.fieldContainer.appendChild(this.el);this.divMess=this.fieldContainer.appendChild(a.cn("div",{id:this.divEl.id+"-mess",className:"inputEx-message"},null,this.options.message))},onHoverStar:function(f){if(!this.disabled){if(!this.value){for(var e=0;e<this.options.nStars;e++){var g=this.starsEls[e],d=g.firstChild;if(e<f+1){c.one(g).addClass("hover");c.one(d).setStyle("width","100%")}else{c.one(g).removeClass("on");c.one(g).removeClass("hover")}}}if(this.options.starsMessages){this.showMessage('<span class="inputEx-starMess">'+this.options.starsMessages[f]+"</span>")}}else{if(this.options.disableMessage){this.showMessage('<span class="inputEx-disableMessage">'+this.options.disableMessage+"</span>")}}},initEvents:function(f,d){this.publish("rateEvt")},resetStars:function(e){if(this.dontReset){return}var l=b.isNumber(e)?e:this.options.averageValue;var j=Math.floor(l),h=Math.floor((this.options.averageValue-j)*10),g;if(h>0){j=j+1;g=h+"0%"}for(var f=0;f<this.options.nStars;f++){var k=this.starsEls[f],d=k.firstChild;c.one(k).removeClass("hover");if(f<j){c.one(k).addClass("on")}else{c.one(k).removeClass("on")}if(f==j-1&&g){c.one(d).setStyle("width",g)}}this.showMessage()},showMessage:function(d){if(!d){var d=this.options.message}this.divMess.innerHTML=d},onAsync:function(){this.showMessage('<span class="thanks">'+a.messages.sendingRate+"</span>")},onEndAsync:function(){this.afterRating()},onClickRating:function(d){if(this.disabled){return}this.setValue(d);this.dontReset=true;this.disable();this.fire("rate",d)},afterRating:function(){this.showMessage('<span class="thanks">'+a.messages.thanksRate+"</span>")},disable:function(){this.disabled=true},enable:function(){this.disabled=false},setValue:function(d){a.RatingStars.superclass.setValue.call(this,d);this.value=d},getValue:function(){return this.value}});a.registerType("ratingstars",a.RatingStars)},"3.0.0a",{requires:["inputex-field"]});